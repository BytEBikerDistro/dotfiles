# Zoxide as cd
eval "$(zoxide init --cmd cd zsh)"
# eval "$(zoxide init --cmd cd bash)"

# FZF color scheme (TokyoNight theme)
export FZF_DEFAULT_OPTS=" --color=bg:#1a1b26,bg+:#24283b,spinner:#bb9af7,hl:#f7768e --color=fg:#c0caf5,header:#7aa2f7,info:#7dcfff,pointer:#7aa2f7 --color=marker:#9ece6a,fg+:#a9b1d6,prompt:#e0af68,hl+:#ff7aa1 --color=selected-bg:#414868 --color=border:#565f89,label:#c0caf5"

# Custom sudo function to redirect apt to apt_wrapper
sudo() {
    if [[ "$1" == "apt" ]]; then
        shift  # Remove 'apt' from arguments
        apt_wrapper "$@"
    else
        command sudo "$@"
    fi
}

# NALA wrapper for apt
apt_wrapper() {
    # Check if sudo is installed
    if ! command -v sudo >/dev/null 2>&1; then
        echo "Error: sudo not found. Please install sudo or run as root."
        return 1
    fi

    # Check if nala is installed, fall back to apt if not
    if ! command -v nala >/dev/null 2>&1; then
        echo "Warning: nala not found, falling back to apt."
        command sudo apt "$@"
        return $?
    fi

    # If no arguments provided, run nala's help menu
    if [[ -z "$1" ]]; then
        command sudo nala
        return
    fi

    local cmd="$1"
    shift

    # Map apt commands to nala equivalents
    case "$cmd" in
        install|in|add)
            command sudo nala install "$@"
            ;;
        search|se*|sr|find)
            command sudo nala search "$@"
            ;;
        update|up)
            command sudo nala update "$@"
            ;;
        upgrade|upg*)
            command sudo nala upgrade "$@"
            ;;
        show|info)
            command sudo nala show "$@"
            ;;
        clean|cl*)
            command sudo nala clean "$@"
            ;;
        autopurge|ap)
            command sudo nala autopurge "$@"
            ;;
        remove|un*|rm|del*|r)
            command sudo nala remove "$@"
            ;;
        list-up*)
            command sudo nala list --upgradable
            ;;
        *)
            command sudo nala "$cmd" "$@"
            ;;
    esac
}
